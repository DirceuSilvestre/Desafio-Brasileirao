{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/dirceusillvestre/notebookcodeanalysis?scriptVersionId=230585595\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"57f24f8f","metadata":{"papermill":{"duration":0.003523,"end_time":"2025-03-30T20:40:48.009064","exception":false,"start_time":"2025-03-30T20:40:48.005541","status":"completed"},"tags":[]},"source":["# Introduction\n","\n","The statistics professor of the undergraduate course in Computer Science at UFRRJ, when watching or hearing news about the games of the Brazilian Championship Series A, felt curious to know if:\n","\n","1 - The number of times that the result with the lowest chance occurred was greater than the most likely result?\n","\n","2 - If he bet the fixed amount of R$100 on each game of the Brazilian Championship Series A on the result with the lowest chance, that \n","is, the one with the highest odds, what would be the value he would have at the end of the championship?\n","\n","And he gave us the task of collecting and analyzing the data in order to obtain the answers to his questions."]},{"cell_type":"code","execution_count":1,"id":"a6e0ae29","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-03-30T20:40:48.016758Z","iopub.status.busy":"2025-03-30T20:40:48.016437Z","iopub.status.idle":"2025-03-30T20:40:49.086387Z","shell.execute_reply":"2025-03-30T20:40:49.085296Z"},"papermill":{"duration":1.075704,"end_time":"2025-03-30T20:40:49.088176","exception":false,"start_time":"2025-03-30T20:40:48.012472","status":"completed"},"tags":[]},"outputs":[],"source":["# Importing libraries into each cell as needed\n","\n","import warnings\n","warnings.filterwarnings('ignore')\n","\n","# Load dataset\n","\n","import pandas as pd\n","\n","df = pd.read_csv('/kaggle/input/2024-brazilian-championship-and-odds/Brasileirao2024.csv', sep=\",\", encoding=\"utf-8\", low_memory=False)"]},{"cell_type":"code","execution_count":2,"id":"9028a8cd","metadata":{"execution":{"iopub.execute_input":"2025-03-30T20:40:49.095873Z","iopub.status.busy":"2025-03-30T20:40:49.09556Z","iopub.status.idle":"2025-03-30T20:40:49.127544Z","shell.execute_reply":"2025-03-30T20:40:49.126136Z"},"papermill":{"duration":0.038104,"end_time":"2025-03-30T20:40:49.129635","exception":false,"start_time":"2025-03-30T20:40:49.091531","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Jogo</th>\n","      <th>Time 1</th>\n","      <th>Time 2</th>\n","      <th>Time Vencedor</th>\n","      <th>Gol Time 1</th>\n","      <th>Gol Time 2</th>\n","      <th>Odd Vitoria Time 1</th>\n","      <th>Odd Vitoria Time 2</th>\n","      <th>Odd Empate</th>\n","      <th>Odd Vencedor</th>\n","      <th>Maior Odd</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>Grêmio</td>\n","      <td>Corinthians</td>\n","      <td>Corinthians</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>2.77</td>\n","      <td>2.70</td>\n","      <td>3.50</td>\n","      <td>2.70</td>\n","      <td>3.50</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>Atlético Mineiro</td>\n","      <td>Athletico Paranaense</td>\n","      <td>Atlético Mineiro</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2.15</td>\n","      <td>4.26</td>\n","      <td>3.42</td>\n","      <td>2.15</td>\n","      <td>4.26</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>Bahia</td>\n","      <td>Atlético Goianiense</td>\n","      <td>Bahia</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>1.50</td>\n","      <td>7.90</td>\n","      <td>5.00</td>\n","      <td>1.50</td>\n","      <td>7.90</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>Flamengo</td>\n","      <td>Vitória</td>\n","      <td>Empate</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>1.40</td>\n","      <td>9.50</td>\n","      <td>5.40</td>\n","      <td>5.40</td>\n","      <td>9.50</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>Botafogo</td>\n","      <td>São Paulo</td>\n","      <td>Botafogo</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1.35</td>\n","      <td>16.50</td>\n","      <td>6.10</td>\n","      <td>1.35</td>\n","      <td>16.50</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   Jogo            Time 1                Time 2     Time Vencedor  Gol Time 1  \\\n","0     1            Grêmio           Corinthians       Corinthians           0   \n","1     2  Atlético Mineiro  Athletico Paranaense  Atlético Mineiro           1   \n","2     3             Bahia   Atlético Goianiense             Bahia           2   \n","3     4          Flamengo               Vitória            Empate           2   \n","4     5          Botafogo             São Paulo          Botafogo           2   \n","\n","   Gol Time 2  Odd Vitoria Time 1  Odd Vitoria Time 2  Odd Empate  \\\n","0           3                2.77                2.70        3.50   \n","1           0                2.15                4.26        3.42   \n","2           0                1.50                7.90        5.00   \n","3           2                1.40                9.50        5.40   \n","4           1                1.35               16.50        6.10   \n","\n","   Odd Vencedor  Maior Odd  \n","0          2.70       3.50  \n","1          2.15       4.26  \n","2          1.50       7.90  \n","3          5.40       9.50  \n","4          1.35      16.50  "]},"execution_count":2,"metadata":{},"output_type":"execute_result"}],"source":["df.head()"]},{"cell_type":"code","execution_count":3,"id":"57b11a20","metadata":{"execution":{"iopub.execute_input":"2025-03-30T20:40:49.137967Z","iopub.status.busy":"2025-03-30T20:40:49.137612Z","iopub.status.idle":"2025-03-30T20:40:49.143889Z","shell.execute_reply":"2025-03-30T20:40:49.142666Z"},"papermill":{"duration":0.01233,"end_time":"2025-03-30T20:40:49.145629","exception":false,"start_time":"2025-03-30T20:40:49.133299","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Jogo                    int64\n","Time 1                 object\n","Time 2                 object\n","Time Vencedor          object\n","Gol Time 1              int64\n","Gol Time 2              int64\n","Odd Vitoria Time 1    float64\n","Odd Vitoria Time 2    float64\n","Odd Empate            float64\n","Odd Vencedor          float64\n","Maior Odd             float64\n","dtype: object\n"]}],"source":["# Verificamos se os tipos dos dados de cada coluna correspondem ao tipo da variavel necessária para sua manipulação adequada\n","\n","print(df.dtypes)"]},{"cell_type":"code","execution_count":4,"id":"1bc5f79e","metadata":{"execution":{"iopub.execute_input":"2025-03-30T20:40:49.153825Z","iopub.status.busy":"2025-03-30T20:40:49.153471Z","iopub.status.idle":"2025-03-30T20:40:49.161021Z","shell.execute_reply":"2025-03-30T20:40:49.159922Z"},"papermill":{"duration":0.013666,"end_time":"2025-03-30T20:40:49.162881","exception":false,"start_time":"2025-03-30T20:40:49.149215","status":"completed"},"tags":[]},"outputs":[],"source":["# Por não estarem totalmente adequados, transformaremos os objetos em string\n","\n","df = df.convert_dtypes()"]},{"cell_type":"code","execution_count":5,"id":"86958d52","metadata":{"execution":{"iopub.execute_input":"2025-03-30T20:40:49.171138Z","iopub.status.busy":"2025-03-30T20:40:49.17078Z","iopub.status.idle":"2025-03-30T20:40:49.176951Z","shell.execute_reply":"2025-03-30T20:40:49.175655Z"},"papermill":{"duration":0.012224,"end_time":"2025-03-30T20:40:49.178694","exception":false,"start_time":"2025-03-30T20:40:49.16647","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Jogo                           Int64\n","Time 1                string[python]\n","Time 2                string[python]\n","Time Vencedor         string[python]\n","Gol Time 1                     Int64\n","Gol Time 2                     Int64\n","Odd Vitoria Time 1           Float64\n","Odd Vitoria Time 2           Float64\n","Odd Empate                   Float64\n","Odd Vencedor                 Float64\n","Maior Odd                    Float64\n","dtype: object\n"]}],"source":["# Para então visualizar se o tipo do dado está correto após a alteração\n","\n","print(df.dtypes)"]},{"cell_type":"code","execution_count":6,"id":"ab52e78d","metadata":{"execution":{"iopub.execute_input":"2025-03-30T20:40:49.187002Z","iopub.status.busy":"2025-03-30T20:40:49.186649Z","iopub.status.idle":"2025-03-30T20:40:49.192411Z","shell.execute_reply":"2025-03-30T20:40:49.191348Z"},"papermill":{"duration":0.011831,"end_time":"2025-03-30T20:40:49.194108","exception":false,"start_time":"2025-03-30T20:40:49.182277","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["(380, 11)"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["# Vamos saber quantas linhas e colunas o dataset possui\n","\n","df.shape"]},{"cell_type":"code","execution_count":7,"id":"2ed3119d","metadata":{"execution":{"iopub.execute_input":"2025-03-30T20:40:49.202429Z","iopub.status.busy":"2025-03-30T20:40:49.202061Z","iopub.status.idle":"2025-03-30T20:40:49.20963Z","shell.execute_reply":"2025-03-30T20:40:49.20859Z"},"papermill":{"duration":0.013392,"end_time":"2025-03-30T20:40:49.211196","exception":false,"start_time":"2025-03-30T20:40:49.197804","status":"completed"},"tags":[]},"outputs":[],"source":["# Eliminamos as linhas com dados faltantes\n","\n","df.dropna(inplace=True)"]},{"cell_type":"code","execution_count":8,"id":"136f48c1","metadata":{"execution":{"iopub.execute_input":"2025-03-30T20:40:49.219747Z","iopub.status.busy":"2025-03-30T20:40:49.219413Z","iopub.status.idle":"2025-03-30T20:40:49.225016Z","shell.execute_reply":"2025-03-30T20:40:49.224138Z"},"papermill":{"duration":0.011623,"end_time":"2025-03-30T20:40:49.226614","exception":false,"start_time":"2025-03-30T20:40:49.214991","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["(380, 11)"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["# Verificamos a quantidade após a eliminação para saber se haviam dados faltantes ou não\n","\n","df.shape"]},{"cell_type":"markdown","id":"00409445","metadata":{"papermill":{"duration":0.00339,"end_time":"2025-03-30T20:40:49.233826","exception":false,"start_time":"2025-03-30T20:40:49.230436","status":"completed"},"tags":[]},"source":["# Graphics"]},{"cell_type":"code","execution_count":9,"id":"cb2ecd6f","metadata":{"execution":{"iopub.execute_input":"2025-03-30T20:40:49.242234Z","iopub.status.busy":"2025-03-30T20:40:49.24192Z","iopub.status.idle":"2025-03-30T20:40:49.89586Z","shell.execute_reply":"2025-03-30T20:40:49.894752Z"},"papermill":{"duration":0.660408,"end_time":"2025-03-30T20:40:49.897779","exception":false,"start_time":"2025-03-30T20:40:49.237371","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["O saldo final após apostar nos 380 jogos do Brasileirão de 2024 é de R$ 5520.0\n","\n","A possibilidade com menor chance de ocorrer aconteceu 81 vezes, e a possibilidade com maior chance de ocorrer se concretizou 299 vezes\n","\n"]},{"data":{"text/html":["<iframe\n","    scrolling=\"no\"\n","    width=\"100%\"\n","    height=\"545px\"\n","    src=\"iframe_figures/figure_9.html\"\n","    frameborder=\"0\"\n","    allowfullscreen\n","></iframe>\n"]},"metadata":{},"output_type":"display_data"}],"source":["# Calculo do resultado final e para o gráfico\n","\n","import plotly.graph_objects as go\n","\n","linha = df.shape[0]\n","\n","acumulador = 0.0\n","\n","vitoria = 0\n","derrota = 0\n","\n","carteira = []\n","\n","for lin in range(linha):\n","    if (df['Odd Vencedor'][lin] == df['Maior Odd'][lin]):\n","        acumulador += (100*df['Maior Odd'][lin])\n","        vitoria += 1\n","    else:\n","        acumulador -= 100\n","        derrota += 1\n","\n","    carteira.append(acumulador)\n","\n","print(f'O saldo final após apostar nos {linha} jogos do Brasileirão de 2024 é de R$ {acumulador}')\n","\n","print()\n","\n","print(f'A possibilidade com menor chance de ocorrer aconteceu {vitoria} vezes, e a possibilidade com maior chance de ocorrer se concretizou {derrota} vezes')\n","\n","print()\n","\n","grafico_carteira = pd.DataFrame()\n","\n","grafico_carteira = df['Jogo'].reset_index()\n","\n","grafico_carteira['Valor Carteira'] = carteira\n","\n","grafico_carteira = grafico_carteira.drop(columns=['index']).reset_index(drop=True)\n","\n","fig = go.Figure()\n","\n","fig.add_trace(go.Scatter(x=grafico_carteira['Jogo'], \n","                         y=grafico_carteira['Valor Carteira'], \n","                         mode='lines+markers',  # Exibe linha e pontos\n","                         name='Carteira',\n","                        line=dict(dash='dot', color='green'),  # Linha pontilhada e verde\n","    marker=dict(\n","        size=5,  # Tamanho dos pontos\n","        color=['blue' if y >= 0 else 'red' for y in grafico_carteira['Valor Carteira']]  # Azul para positivos, vermelho para negativos\n","    ) )) \n","\n","fig.update_layout(title=\"Valores de Retorno após Cada Jogo\", xaxis_title=\"Jogo\", yaxis_title=\"Valor Carteira\")\n","\n","fig.show(renderer='iframe')"]},{"cell_type":"code","execution_count":null,"id":"2f06bdd9","metadata":{"papermill":{"duration":0.003578,"end_time":"2025-03-30T20:40:49.905507","exception":false,"start_time":"2025-03-30T20:40:49.901929","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"datasetId":7005351,"sourceId":11217846,"sourceType":"datasetVersion"}],"dockerImageVersionId":30918,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.12"},"papermill":{"default_parameters":{},"duration":5.387693,"end_time":"2025-03-30T20:40:50.531051","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-03-30T20:40:45.143358","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}